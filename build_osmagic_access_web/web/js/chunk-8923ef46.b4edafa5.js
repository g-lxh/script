(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8923ef46"],{"921d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"page-card-content"},[t("div",{staticClass:"top-area"},[t("el-descriptions",[t("el-descriptions-item",{attrs:{label:"平台名称"}},[e._v(e._s(e.row.name))]),t("el-descriptions-item",{attrs:{label:"平台描述"}},[e._v(e._s(e.row.desc))]),t("el-descriptions-item",{attrs:{label:"链接"}},[e._v(e._s(e.row.url))])],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleRowClick("add")}}},[e._v("新增")])],1),t("el-table",{attrs:{data:e.tableData,stripe:"","row-key":"id","header-cell-style":{background:"#f7f8fb"},height:"620","default-expand-all":"","tree-props":{children:"children",hasChildren:"haChildren"}}},[e._v(" > "),t("template",{slot:"empty"},[t("div",{staticClass:"empty-img"},[t("img",{attrs:{src:a("b45c")}}),t("p",[e._v("暂无数据")])])]),t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:"名称",prop:"name"}}),t("el-table-column",{attrs:{label:"图标",prop:"icon"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.icon?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a.row.icon}}):t("span",[e._v("无")])]}}])}),t("el-table-column",{attrs:{label:"授权标识",prop:"code"}}),t("el-table-column",{attrs:{label:"类型",prop:"type"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("filterType")(a.row.type)))])]}}])}),t("el-table-column",{attrs:{label:"排序",prop:"sort"}}),t("el-table-column",{attrs:{label:"路由",prop:"route"}}),t("el-table-column",{attrs:{label:"状态",prop:"hided"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("filterHided")(a.row.hided)))])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleRowClick("editor",a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleRowClick("detail",a.row)}}},[e._v("详情")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleRowClick("hidden",a.row)}}},[e._v(e._s(a.row.hided?"隐藏":"显示"))]),t("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text"},on:{click:function(t){return e.handleRowClick("delete",a.row)}}},[e._v("删除")])]}}])})],2),t("el-dialog",{staticStyle:{"margin-top":"-20px"},attrs:{title:"editor"==e.operationType?"编辑":"add"==e.operationType?"新增":"详情",width:"600px",visible:e.dialogVisible,"close-on-click-modal":!1,"label-width":"120px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"100px",rules:e.formRules}},[t("el-form-item",{attrs:{label:"类型"}},[t("el-radio-group",{attrs:{disabled:"detail"==e.operationType},on:{change:e.choseType},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},[t("el-radio",{attrs:{label:"1"}},[e._v("菜单")]),t("el-radio",{attrs:{label:"2"}},[e._v("按钮")])],1)],1),t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{staticClass:"labelWidth",attrs:{maxlength:"6",disabled:"detail"==e.operationType},on:{input:function(t){return e.changeMessage()}},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),t("el-form-item",{attrs:{label:"排序",prop:"sort"}},[t("el-input",{staticClass:"labelWidth",attrs:{maxlength:"150",type:"number",disabled:"detail"==e.operationType},model:{value:e.addForm.sort,callback:function(t){e.$set(e.addForm,"sort",t)},expression:"addForm.sort"}})],1),1==e.addForm.type?t("el-form-item",{attrs:{label:"路由",prop:"route"}},[t("el-input",{staticClass:"labelWidth",attrs:{maxlength:"150",disabled:"detail"==e.operationType},model:{value:e.addForm.route,callback:function(t){e.$set(e.addForm,"route",t)},expression:"addForm.route"}})],1):e._e(),t("el-form-item",{attrs:{label:"授权标识",prop:"code"}},[t("el-input",{staticClass:"labelWidth",attrs:{maxlength:"150",disabled:"add"!=e.operationType},model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1),1==e.addForm.type?t("el-form-item",{attrs:{label:"图标"}},[t("el-upload",{ref:"imgUpload",attrs:{action:"","file-list":e.fileList,"list-type":"picture-card","on-change":e.handleFileChange,"on-remove":e.handleRemove,"on-exceed":e.handleExceed,accept:".png,.jpeg,.jpg,.bmp",multiple:"",limit:1,"auto-upload":!1}},[t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1):e._e(),t("el-form-item",{attrs:{label:1==e.addForm.type?"上级菜单":"菜单",prop:"parentId"}},[t("el-cascader",{attrs:{options:e.options,clearable:"",props:{checkStrictly:!0,value:"id",label:"name",children:"children"},disabled:"detail"==e.operationType},model:{value:e.addForm.parentId,callback:function(t){e.$set(e.addForm,"parentId",t)},expression:"addForm.parentId"}})],1),"detail"==e.operationType?t("el-form-item",{attrs:{label:"最后更新人"}},[t("el-input",{staticClass:"labelWidth",attrs:{disabled:"detail"==e.operationType},model:{value:e.addForm.updater,callback:function(t){e.$set(e.addForm,"updater",t)},expression:"addForm.updater"}})],1):e._e(),"detail"==e.operationType?t("el-form-item",{attrs:{label:"最后更新时间"}},[t("el-input",{staticClass:"labelWidth",attrs:{disabled:"detail"==e.operationType},model:{value:e.addForm.updateTime,callback:function(t){e.$set(e.addForm,"updateTime",t)},expression:"addForm.updateTime"}})],1):e._e(),"detail"==e.operationType?t("el-form-item",{attrs:{label:"创建人"}},[t("el-input",{staticClass:"labelWidth",attrs:{disabled:"detail"==e.operationType},model:{value:e.addForm.creator,callback:function(t){e.$set(e.addForm,"creator",t)},expression:"addForm.creator"}})],1):e._e(),"detail"==e.operationType?t("el-form-item",{attrs:{label:"创建时间"}},[t("el-input",{staticClass:"labelWidth",attrs:{disabled:"detail"==e.operationType},model:{value:e.addForm.createTime,callback:function(t){e.$set(e.addForm,"createTime",t)},expression:"addForm.createTime"}})],1):e._e(),t("el-form-item",[t("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.submitForm}},[e._v(" "+e._s("detail"==e.operationType?"关闭":"保存")+" ")]),"detail"!=e.operationType?t("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{type:"primary",plain:""},on:{click:function(t){return e.submitForm(1)}}},[e._v(" 取消 ")]):e._e()],1)],1)],1)],1)},s=[],r=a("365c"),l={filters:{filterType(e){return 1==e?"菜单":"按钮"},filterHided(e){return e?"显示":"隐藏"}},data(){return{loading:!1,tableData:[],pageInfo:{pageSizes:[10,20,50],total:0},dialogVisible:!1,operationType:"add",addForm:{code:"",icon:"",name:"",parentId:0,platformId:0,route:"",sort:null,type:"1"},formRules:{name:[{trigger:"blur",message:"请输入正确名称（支持中文，英文大小写）",required:!0,pattern:"^[a-zA-Z\\u4e00-\\u9fa5]+$"}],url:[{trigger:"blur",message:"请输入正确名称（支持中文，英文大小写）",required:!0}],parentId:[{trigger:"change",message:"请选择上级菜单",required:!0}]},options:[{hasChildren:!0,id:-1,level:0,name:"根目录",parentId:null,roleAuth:null,children:[]}],optionProps:{value:"id",label:"name",children:"children"},fileList:[],row:{}}},created(){this.row={id:this.$route.query.id,desc:this.$route.query.desc,name:this.$route.query.name,url:this.$route.query.url}},mounted(){this.getTableData(),this.getMenuTree()},methods:{changeMessage(){this.$forceUpdate()},choseType(e){2==e&&(this.addForm.route&&delete this.addForm.route,this.addForm.icon&&delete this.addForm.icon)},getMenuTree(){r["a"].getMenuList({platformId:this.row.id,type:1}).then(e=>{200==e.status?this.options[0].children=e.data:this.$message.error(e.message)})},submitForm(e){1==e?(this.$refs.addForm.resetFields(),this.dialogVisible=!1,this.fileList=[]):this.$refs.addForm.validate(e=>{e?(this.addForm.parentId=this.addForm.parentId[this.addForm.parentId.length-1],this.addForm.platformId=parseInt(this.row.id),this.addForm.sort=parseInt(this.addForm.sort),this.addForm.id?r["a"].getMenuModify(this.addForm).then(e=>{200==e.status?(this.dialogVisible=!1,this.$refs.addForm.resetFields(),this.$message.success("保存成功"),this.getTableData(),this.getMenuTree(),this.fileList=[]):this.$message.error(e.message)}):r["a"].getMenuAdd(this.addForm).then(e=>{200==e.status?(this.dialogVisible=!1,this.$refs.addForm.resetFields(),this.$message.success("保存成功"),this.getTableData(),this.getMenuTree(),this.fileList=[]):this.$message.error(e.message)})):this.$message.error("请检查表单内容是否填写完整")})},handleImgExceed(){this.$message.warning("您当前选择的图标过多，最多只能上传一张图标")},handleFileChange(e,t){this.fileList=t;const a=new FormData;a.append("label","nice"),a.append("file",e.raw),r["a"].uploadFile(a).then(e=>{200==e.status&&(this.addForm.icon=e.data)})},handleRemove(e,t){this.fileList=t,this.addForm.icon=""},handleExceed(){this.$message("只能选择一张图标！")},handleRowClick(e,t){switch(e){case"add":this.dialogVisible=!0,this.operationType="add",this.addForm={code:"",icon:"",name:"",parentId:0,platformId:0,route:"",sort:null,type:"1"};break;case"editor":this.operationType="editor",this.getMenuDetail(t.id);break;case"delete":this.getDelete(t);break;case"hidden":this.getHide(t);break;case"detail":this.operationType="detail",this.getMenuDetail(t.id);break}},getMenuDetail(e){r["a"].getMenuDetail({id:e}).then(e=>{200==e.status?(this.addForm=e.data,this.addForm.type=e.data.type.toString(),e.data.parentIds.forEach(e=>{e+="",console.log(e)}),this.addForm.parentId=e.data.parentIds,0==this.addForm.parentId.length?this.addForm.parentId=[-1]:this.addForm.parentId.splice(0,0,-1),"1"==this.addForm.type&&this.addForm.icon&&this.fileList.push({url:this.addForm.icon}),this.dialogVisible=!0):this.$message.error(e.message)})},getDelete(e){const t=[];t.push(e),this.$confirm("删除以后数据不可恢复，请谨慎操作！","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.loading=!0,r["a"].getMenuDelete({ids:t}).then(e=>{200==e.status?(this.$message.success(e.message),this.getTableData()):this.$message.error(e.message)}).finally(()=>{this.loading=!1})})},getHide(e){var t={id:e.id,hided:!e.hided,name:e.name,type:e.type},a="";a=e.hided?"隐藏":"显示",this.$confirm(`是否${a}该菜单！`,""+a,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.loading=!0,r["a"].getMenuModify(t).then(e=>{200==e.status?(this.$message.success(e.message),this.getTableData(),this.getMenuTree()):this.$message.error(e.message)}).finally(()=>{this.loading=!1})})},getTableData(){this.loading=!0;const e={};e.platformId=parseInt(this.row.id),r["a"].getMenuListAsc(e).then(e=>{200==e.status?(this.pageInfo.total=e.data.total,this.tableData=e.data):this.$message.error(e.message)}).finally(()=>{this.loading=!1})},handlePageChanged(e){this.searchForm.pageNum=e,this.getTableData(!1)},handlePageSizeChanged(e){this.searchForm.pageSize=e,this.getTableData(!1)}}},o=l,d=a("2877"),n=Object(d["a"])(o,i,s,!1,null,"25234a96",null);t["default"]=n.exports},b45c:function(e,t,a){e.exports=a.p+"img/empty.b4816776.png"}}]);
//# sourceMappingURL=chunk-8923ef46.b4edafa5.js.map